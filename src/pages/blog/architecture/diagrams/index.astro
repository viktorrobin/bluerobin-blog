---
import MainLayout from "@layouts/MainLayout.astro";

const diagrams = [
  {
    slug: "rag-pipeline",
    title: "RAG Query Pipeline",
    description: "Sequence diagram showing the Retrieval Augmented Generation (RAG) query flow",
    type: "Sequence Diagram",
    topic: "AI",
    icon: "ü§ñ"
  },
  {
    slug: "document-ingestion",
    title: "Document Ingestion Pipeline",
    description: "Flowchart showing the complete document processing pipeline from upload to searchable",
    type: "Flowchart",
    topic: "Architecture",
    icon: "üìÑ"
  },
  {
    slug: "event-driven-architecture",
    title: "Event-Driven Architecture",
    description: "Sequence diagram showing NATS JetStream event flow for document processing",
    type: "Sequence Diagram",
    topic: "Architecture",
    icon: "üì¨"
  },
  {
    slug: "kubernetes-deployment",
    title: "Kubernetes Deployment",
    description: "Architecture diagram showing K3s cluster deployment topology and namespace organization",
    type: "Architecture Diagram",
    topic: "Infrastructure",
    icon: "‚ò∏Ô∏è"
  },
  {
    slug: "domain-model",
    title: "Domain Model",
    description: "Class diagram showing the DDD domain model with aggregates, entities, and value objects",
    type: "Class Diagram",
    topic: "DDD",
    icon: "üèõÔ∏è"
  },
  {
    slug: "cicd-pipeline",
    title: "CI/CD Pipeline",
    description: "Flowchart showing the GitOps-based CI/CD pipeline with GitHub Actions and FluxCD",
    type: "Flowchart",
    topic: "DevOps",
    icon: "üîÑ"
  },
  {
    slug: "microservices-communication",
    title: "Microservices Communication",
    description: "C4 Container diagram showing service-to-service communication patterns",
    type: "C4 Diagram",
    topic: "Architecture",
    icon: "üîó"
  },
  {
    slug: "cqrs-pattern",
    title: "CQRS Pattern",
    description: "Component diagram showing Command Query Responsibility Segregation implementation",
    type: "Component Diagram",
    topic: "Architecture",
    icon: "‚ö°"
  }
];

const topicColors: Record<string, string> = {
  "AI": "bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",
  "Architecture": "bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",
  "Infrastructure": "bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",
  "DDD": "bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",
  "DevOps": "bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"
};
---

<MainLayout title="Architecture Diagrams | BlueRobin Tech Blog" description="Visual architecture diagrams for BlueRobin system design">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <header class="mb-12">
      <div class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200 mb-4">
        üìä Architecture Diagrams
      </div>
      <h1 class="text-3xl sm:text-4xl font-display font-bold text-slate-900 dark:text-slate-100 mb-4">
        System Architecture Diagrams
      </h1>
      <p class="text-lg text-slate-600 dark:text-slate-400 max-w-2xl">
        Visual representations of BlueRobin's architecture using Mermaid diagrams. 
        Each diagram is interactive and can be embedded in documentation or presentations.
      </p>
    </header>

    <!-- Structurizr DSL Notice -->
    <div class="glass-card p-6 mb-8 border-l-4 border-indigo-500">
      <h3 class="font-semibold text-slate-900 dark:text-slate-100 mb-2">
        üìê Full C4 Model Available
      </h3>
      <p class="text-slate-600 dark:text-slate-400 text-sm mb-3">
        For the complete interactive C4 model with drill-down navigation (System Context ‚Üí Container ‚Üí Component ‚Üí Deployment), 
        use the Structurizr DSL file:
      </p>
      <code class="text-sm bg-slate-100 dark:bg-slate-800 px-3 py-1 rounded">
        /architecture/bluerobin.dsl
      </code>
      <p class="text-slate-500 dark:text-slate-500 text-xs mt-2">
        Open at <a href="https://structurizr.com/dsl" class="text-indigo-600 dark:text-indigo-400 hover:underline">structurizr.com/dsl</a> 
        or export to PlantUML with structurizr-cli.
      </p>
    </div>

    <!-- Diagram Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {diagrams.map((diagram) => (
        <article class="glass-card p-6 hover:shadow-lg transition-all group">
          <div class="flex items-start justify-between mb-4">
            <span class="text-3xl">{diagram.icon}</span>
            <span class={`text-xs px-2 py-1 rounded-full ${topicColors[diagram.topic]}`}>
              {diagram.topic}
            </span>
          </div>
          
          <h2 class="text-xl font-semibold text-slate-900 dark:text-slate-100 mb-2 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors">
            <a href={`/architecture/diagrams/${diagram.slug}`}>
              {diagram.title}
            </a>
          </h2>
          
          <p class="text-slate-600 dark:text-slate-400 text-sm mb-4">
            {diagram.description}
          </p>
          
          <div class="flex items-center justify-between">
            <span class="text-xs text-slate-500 dark:text-slate-500">
              {diagram.type}
            </span>
            <a 
              href={`/architecture/diagrams/${diagram.slug}`}
              class="text-sm text-indigo-600 dark:text-indigo-400 hover:underline"
            >
              View Diagram ‚Üí
            </a>
          </div>
        </article>
      ))}
    </div>

    <!-- Diagram Types Legend -->
    <section class="mt-12">
      <h2 class="text-2xl font-display font-bold text-slate-900 dark:text-slate-100 mb-6">
        Diagram Types Used
      </h2>
      
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="glass-card p-4">
          <h3 class="font-semibold text-slate-900 dark:text-slate-100 mb-1">Sequence Diagrams</h3>
          <p class="text-sm text-slate-600 dark:text-slate-400">Show interactions between components over time</p>
        </div>
        <div class="glass-card p-4">
          <h3 class="font-semibold text-slate-900 dark:text-slate-100 mb-1">Flowcharts</h3>
          <p class="text-sm text-slate-600 dark:text-slate-400">Illustrate process flows and decision points</p>
        </div>
        <div class="glass-card p-4">
          <h3 class="font-semibold text-slate-900 dark:text-slate-100 mb-1">Class Diagrams</h3>
          <p class="text-sm text-slate-600 dark:text-slate-400">Model domain entities and relationships</p>
        </div>
        <div class="glass-card p-4">
          <h3 class="font-semibold text-slate-900 dark:text-slate-100 mb-1">C4 Diagrams</h3>
          <p class="text-sm text-slate-600 dark:text-slate-400">Multi-level architecture visualization</p>
        </div>
      </div>
    </section>

    <!-- Usage Instructions -->
    <section class="mt-12">
      <h2 class="text-2xl font-display font-bold text-slate-900 dark:text-slate-100 mb-6">
        Using These Diagrams
      </h2>
      
      <div class="glass-card p-6">
        <div class="prose dark:prose-invert max-w-none">
          <h3>Embedding in Documentation</h3>
          <p>All diagrams use Mermaid syntax and can be embedded in:</p>
          <ul>
            <li>GitHub README files (native Mermaid support)</li>
            <li>Notion pages (via Mermaid code blocks)</li>
            <li>Confluence (via Mermaid macro)</li>
            <li>MkDocs (via mermaid2 plugin)</li>
          </ul>
          
          <h3>Exporting to Images</h3>
          <p>Use the Mermaid CLI to export:</p>
          <pre><code>npx @mermaid-js/mermaid-cli -i diagram.md -o diagram.svg</code></pre>
          
          <h3>Structurizr DSL</h3>
          <p>The comprehensive C4 model in <code>/architecture/bluerobin.dsl</code> can be:</p>
          <ul>
            <li>Rendered interactively at structurizr.com</li>
            <li>Exported to PlantUML, PNG, or SVG</li>
            <li>Embedded in architecture documentation</li>
          </ul>
        </div>
      </div>
    </section>
  </div>
</MainLayout>
